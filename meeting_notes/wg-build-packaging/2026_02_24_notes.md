
## WG Build and Packaging

**Note taker:** Nicolas

### General
- Presentation at upcoming HPSF. Jakob will need input for the slides.
- Need to define a clearer roadmap for the wg. I will setup a github kanban to track ideas and set up their priorities.
Beginning of the list:
  + cleaning up Kokkos recipe
  + cleaning up Kokkos Kernels recipe
  + mdspan as a dependency
  + removing nvcc_wrapper in Spack?
  + `+wrapper` for hipcc?
  + Kokkos ecosystem without compiler wrapper?
  + More install methods via package managers https://github.com/kokkos/kokkos-core-wiki/pull/662
  + Do we want binary packaging yes/no? If yes, how? do we reclaim all unofficial packages? Where do we build them (oldest os versions that are currently supported ... but we would need something like a set that we want to support)
  + Homogenizing the build and packaging of the ecosystem packages
  + Regular audit on the pages of the documentation that fall within our expertise

We need a list of topics with priorities and estimates of how much time this will consume.

### Packaging

- In general we should come up with a plan how to support/integrate into any kind of package manager, including binary ones.
- What to do with the misuse of CMake components: https://github.com/kokkos/kokkos/pull/8698


#### Spack

PR:

- [kokkos: bring back deprecated_code variant #3154](https://github.com/spack/spack-packages/pull/3154)

- [Kokkos-FFT: version 1.0.0 #3133](https://github.com/spack/spack-packages/pull/3133) merged

- [\[kokkos\]: version 5.0.2 #3269](https://github.com/spack/spack-packages/pull/3269) merged

Issues:

- mdspan as a dependency: not high priority but we should allow it in the future

- kokkos-nvcc-wrapper removal in Spack?

Checklist proposal:

1. **Update `kokkos` package**:
   - [ ] Add a new version entry: `version("x.y.z", sha256="checksum_of_kokkos_x.y.z.tar.gz")`.
   - [ ] Ensure dependencies are up to date.
   - [ ] Ensure variants are up to date.
   - [ ] Check if variants default values are up to date.

2. **Update `kokkos-nvcc-wrapper` package**:
   - [ ] Add a new version entry: `version("x.y.z", sha256="checksum_of_kokkos_x.y.z.tar.gz")`.

3. **Update `kokkos-kernels` package**:
   - [ ] Add a new version entry: `version("x.y.z", sha256="checksum_of_kokkos_kernels_x.y.z.tar.gz")`.
   - [ ] Add the dependency to the package kokkos: `depends_on("kokkos@x.y.z", when="@x.y.z")`.
   - [ ] Ensure dependencies are up to date.
   - [ ] Ensure variants are up to date.

Maybe the checklists should live in a subdir `checklists` of our meeting notes?

### Build

## Notes

* Jakob:
   * Need a roadmap and things to tackle for the wg
   * Binary packaging especially for downstream
      * Nic:
         * My issue is mainly maintenance burden
         * I'm okay with cpack since it can be used for apps to make their own packages if they would like
         * I don't mind if the packages exist, I just don't want to maintian them
   * MOre discussion of binary poackage
      * Christoph, Luc:
         * See most of our users to be users of kokkos applications
            * Make those easy to install
         * Luc: even see us 2 or 3 degrees away from the user
   * Jakob will continue work on cpack PR so we can understand more
      * Test against binary package generated by cpack
   * Nic: can get an informal straw poll at hpsf who would be interested in a system binary package
* Luc: quesiton about TPLs
   * DO we have guidance on how we should integrate TPLs in build systems
   * Nic:
      * In core there are two things for required package:
         * Snapshot package and bundle source
         * Have option to use external version of package
   * Luc
      * _shows example of finding blas_
      * Relying a lot on find_package
   * Nic: my suggestion
      * Use find_package
      * Use snapshots for required dependency if you want (but provide find_package option)
      * Minimize use of Find*.cmake if possible
   * Luc: versioning?
      * Jakob: yes but we need to be careful
      * Luc: some dependencies might be a bit less strict on versioning, but we may need to do something

### Attendees
- Nicolas Morales
- Christoph Junghans
- Richard Berger
- Luc Berger-Vergiat
